{"version":3,"sources":["../../src/fit-bounds.js"],"names":["fitBounds","width","height","bounds","padding","offset","west","south","east","north","Number","isFinite","p","top","bottom","left","right","viewport","WebMercatorViewport","longitude","latitude","zoom","nw","project","se","size","Math","abs","targetSize","scaleX","scaleY","offsetX","offsetY","center","centerLngLat","unproject","log2","min"],"mappings":"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","sourcesContent":["import WebMercatorViewport from './web-mercator-viewport';\nimport assert from './assert';\n\n/**\n * * An object describing the padding to add to the bounds.\n * @typedef {Object} PaddingObject\n * @property {Number} top - Padding from top in pixels to add to the given bounds\n * @property {Number} bottom - Padding from bottom in pixels to add to the given bounds\n * @property {Number} left - Padding from left in pixels to add to the given bounds\n * @property {Number} right - Padding from right in pixels to add to the given bounds\n */\n\n/**\n * Returns map settings {latitude, longitude, zoom}\n * that will contain the provided corners within the provided width.\n * Only supports non-perspective mode.\n * @param {Number} width - viewport width\n * @param {Number} height - viewport height\n * @param {Array} bounds - [[lon, lat], [lon, lat]]\n * @param {Number|PaddingObject} [padding] - The amount of padding in pixels\n *  to add to the given bounds. Can also be an object with top, bottom, left and right\n *  properties defining the padding.\n * @param {Array} [offset] - The center of the given bounds relative to the map's center,\n *    [x, y] measured in pixels.\n * @returns {Object} - latitude, longitude and zoom\n */\nexport default function fitBounds({\n  width,\n  height,\n  bounds,\n  // options\n  padding = 0,\n  offset = [0, 0]\n}) {\n  const [[west, south], [east, north]] = bounds;\n\n  if (Number.isFinite(padding)) {\n    const p = padding;\n    padding = {\n      top: p,\n      bottom: p,\n      left: p,\n      right: p\n    };\n  } else {\n    // Make sure all the required properties are set\n    assert(Number.isFinite(padding.top) &&\n      Number.isFinite(padding.bottom) &&\n      Number.isFinite(padding.left) &&\n      Number.isFinite(padding.right)\n    );\n  }\n\n  const viewport = new WebMercatorViewport({\n    width,\n    height,\n    longitude: 0,\n    latitude: 0,\n    zoom: 0\n  });\n\n  const nw = viewport.project([west, north]);\n  const se = viewport.project([east, south]);\n\n  // width/height on the Web Mercator plane\n  const size = [\n    Math.abs(se[0] - nw[0]),\n    Math.abs(se[1] - nw[1])\n  ];\n\n  const targetSize = [\n    width - padding.left - padding.right - Math.abs(offset[0]) * 2,\n    height - padding.top - padding.bottom - Math.abs(offset[1]) * 2\n  ];\n\n  assert(targetSize[0] > 0 && targetSize[1] > 0);\n\n  // scale = screen pixels per unit on the Web Mercator plane\n  const scaleX = targetSize[0] / size[0];\n  const scaleY = targetSize[1] / size[1];\n\n  // Find how much we need to shift the center\n  const offsetX = (padding.right - padding.left) / 2 / scaleX;\n  const offsetY = (padding.bottom - padding.top) / 2 / scaleY;\n\n  const center = [\n    (se[0] + nw[0]) / 2 + offsetX,\n    (se[1] + nw[1]) / 2 + offsetY\n  ];\n\n  const centerLngLat = viewport.unproject(center);\n  const zoom = viewport.zoom + Math.log2(Math.abs(Math.min(scaleX, scaleY)));\n\n  return {\n    longitude: centerLngLat[0],\n    latitude: centerLngLat[1],\n    zoom\n  };\n}\n"],"file":"fit-bounds.js"}