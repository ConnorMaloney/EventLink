{"version":3,"sources":["../../../src/components/static-map.js"],"names":["TOKEN_DOC_URL","NO_TOKEN_WARNING","StaticContext","viewport","map","noop","UNAUTHORIZED_ERROR_CODE","CONTAINER_STYLE","position","width","height","overflow","propTypes","Object","assign","Mapbox","PropTypes","oneOfType","number","string","onResize","func","preventStyleDiffing","bool","disableTokenWarning","visible","className","style","object","visibilityConstraints","defaultProps","MAPBOX_LIMITS","StaticMap","accessTokenInvalid","_map","geometry","options","queryRenderedFeatures","evt","statusCode","error","status","state","console","setState","props","onError","supported","mapStyle","_mapbox","mapboxgl","_width","_height","container","_mapboxMapRef","current","_mapboxMapError","getMap","prevProps","_updateMapStyle","_updateMapProps","finalize","oldProps","newProps","oldMapStyle","setStyle","diff","setProps","left","top","key","id","href","dimensions","Number","_updateMapSize","staticContext","WebMercatorViewport","viewState","Provider","value","children","mapContainerStyle","visibility","ref","AutoSizer","disableWidth","isFinite","disableHeight","_renderOverlays","bind","_renderNoTokenWarning","PureComponent"],"mappings":"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","sourcesContent":["// @flow\n// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport {PureComponent, createElement, createContext, createRef} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {normalizeStyle} from '../utils/style-utils';\n\nimport WebMercatorViewport from 'viewport-mercator-project';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport Mapbox from '../mapbox/mapbox';\nimport mapboxgl from '../utils/mapboxgl';\nimport {checkVisibilityConstraints} from '../utils/map-constraints';\nimport {MAPBOX_LIMITS} from '../utils/map-state';\n\nimport type {ViewState} from '../mapbox/mapbox';\nimport type {Node} from 'react';\n\n/* eslint-disable max-len */\nconst TOKEN_DOC_URL = 'https://uber.github.io/react-map-gl/#/Documentation/getting-started/about-mapbox-tokens';\nconst NO_TOKEN_WARNING = 'A valid API access token is required to use Mapbox data';\n/* eslint-disable max-len */\n\nexport const StaticContext = createContext({\n  viewport: null,\n  map: null\n});\n\nfunction noop() {}\n\nconst UNAUTHORIZED_ERROR_CODE = 401;\n\nconst CONTAINER_STYLE = {\n  position: 'absolute',\n  width: '100%',\n  height: '100%',\n  overflow: 'hidden'\n};\n\nconst propTypes = Object.assign({}, Mapbox.propTypes, {\n  /** The dimensions of the map **/\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n\n  /** Callback when map size changes **/\n  onResize: PropTypes.func,\n  /** There are known issues with style diffing. As stopgap, add option to prevent style diffing. */\n  preventStyleDiffing: PropTypes.bool,\n  /** Hide invalid token warning even if request fails */\n  disableTokenWarning: PropTypes.bool,\n  /** Whether the map is visible */\n  visible: PropTypes.bool,\n  /** Custom class name for the map */\n  className: PropTypes.string,\n  /** Custom CSS for the container */\n  style: PropTypes.object,\n\n  /** Advanced features */\n  // Contraints for displaying the map. If not met, then the map is hidden.\n  // Experimental! May be changed in minor version updates.\n  visibilityConstraints: PropTypes.object\n});\n\nconst defaultProps = Object.assign({}, Mapbox.defaultProps, {\n  preventStyleDiffing: false,\n  disableTokenWarning: false,\n  visible: true,\n  onResize: noop,\n  className: '',\n  style: null,\n  visibilityConstraints: MAPBOX_LIMITS\n});\n\nexport type StaticMapProps = {\n  gl?: any,\n  width: number | string,\n  height: number | string,\n  preventStyleDiffing: boolean,\n  disableTokenWarning: false,\n  visible: boolean,\n  className: string,\n  style: any,\n  visibilityConstraints: any,\n  children?: Node,\n  onLoad: Function,\n  onError: Function,\n  onResize: Function,\n  mapStyle: any,\n  visible: boolean,\n  viewState?: ViewState,\n  longitude: number,\n  latitude: number,\n  zoom: number,\n  bearing: number,\n  pitch: number,\n  altitude?: number\n};\n\ntype State = {\n  accessTokenInvalid: boolean\n};\n\nexport default class StaticMap extends PureComponent<StaticMapProps, State> {\n  static supported() {\n    return mapboxgl && mapboxgl.supported();\n  }\n\n  static propTypes : any = propTypes;\n  static defaultProps : StaticMapProps = defaultProps;\n\n  state : State = {\n    accessTokenInvalid: false\n  };\n\n  componentDidMount() {\n    if (!StaticMap.supported()) {\n      return;\n    }\n    const {mapStyle} = this.props;\n\n    // $FlowFixMe\n    this._mapbox = new Mapbox(Object.assign({}, this.props, {\n      mapboxgl, // Handle to mapbox-gl library\n      width: this._width,\n      height: this._height,\n      container: this._mapboxMapRef.current,\n      onError: this._mapboxMapError,\n      mapStyle: normalizeStyle(mapStyle)\n    }));\n    this._map = this._mapbox.getMap();\n  }\n\n  componentDidUpdate(prevProps : StaticMapProps) {\n    if (this._mapbox) {\n      this._updateMapStyle(prevProps, this.props);\n      this._updateMapProps(this.props);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this._mapbox) {\n      this._mapbox.finalize();\n      this._mapbox = null;\n      this._map = null;\n    }\n  }\n\n  _mapbox : any = null;\n  _map : any = null;\n  _mapboxMapRef: { current: null | HTMLDivElement } = createRef();\n  _queryParams : any = {};\n  _width : number = 0;\n  _height : number = 0;\n\n  // External apps can access map this way\n  getMap = () => {\n    return this._map;\n  }\n\n  /** Uses Mapbox's\n    * queryRenderedFeatures API to find features at point or in a bounding box.\n    * https://www.mapbox.com/mapbox-gl-js/api/#Map#queryRenderedFeatures\n    * To query only some of the layers, set the `interactive` property in the\n    * layer style to `true`.\n    * @param {[Number, Number]|[[Number, Number], [Number, Number]]} geometry -\n    *   Point or an array of two points defining the bounding box\n    * @param {Object} options - query options\n    */\n  queryRenderedFeatures = (geometry : any, options : any = {}) => {\n    return this._map.queryRenderedFeatures(geometry, options);\n  }\n\n  // Note: needs to be called after render (e.g. in componentDidUpdate)\n  _updateMapSize(width : number, height : number) {\n    if (this._width !== width || this._height !== height) {\n      this._width = width;\n      this._height = height;\n      this._updateMapProps(this.props);\n    }\n  }\n\n  _updateMapStyle(oldProps : StaticMapProps, newProps : StaticMapProps) {\n    const mapStyle = newProps.mapStyle;\n    const oldMapStyle = oldProps.mapStyle;\n    if (mapStyle !== oldMapStyle) {\n      this._map.setStyle(normalizeStyle(mapStyle), {diff: !this.props.preventStyleDiffing});\n    }\n  }\n\n  _updateMapProps(props : StaticMapProps) {\n    if (!this._mapbox) {\n      return;\n    }\n    this._mapbox.setProps(Object.assign({}, props, {\n      width: this._width,\n      height: this._height\n    }));\n  }\n\n  // Handle map error\n  _mapboxMapError = (evt : {\n    error?: {\n      message: string,\n      status: number\n    },\n    status: number\n  }) => {\n    const statusCode = evt.error && evt.error.status || evt.status;\n    if (statusCode === UNAUTHORIZED_ERROR_CODE && !this.state.accessTokenInvalid) {\n      // Mapbox throws unauthorized error - invalid token\n      console.error(NO_TOKEN_WARNING); // eslint-disable-line\n      this.setState({accessTokenInvalid: true});\n    }\n    this.props.onError(evt);\n  }\n\n  _renderNoTokenWarning() {\n    if (this.state.accessTokenInvalid && !this.props.disableTokenWarning) {\n      const style = {\n        position: 'absolute',\n        left: 0,\n        top: 0\n      };\n      return (\n        createElement('div', {key: 'warning', id: 'no-token-warning', style}, [\n          createElement('h3', {key: 'header'}, NO_TOKEN_WARNING),\n          createElement('div', {key: 'text'}, 'For information on setting up your basemap, read'),\n          createElement('a', {key: 'link', href: TOKEN_DOC_URL}, 'Note on Map Tokens')\n        ])\n      );\n    }\n\n    return null;\n  }\n\n  _renderOverlays(dimensions : {\n    width?: number,\n    height?: number\n  }) {\n    const {\n      width = Number(this.props.width),\n      height = Number(this.props.height)\n    } = dimensions;\n    this._updateMapSize(width, height);\n\n    const staticContext = {\n      // $FlowFixMe\n      viewport: new WebMercatorViewport(Object.assign({}, this.props, this.props.viewState, {\n        width,\n        height\n      })),\n      map: this._map\n    };\n\n    return createElement(StaticContext.Provider, {value: staticContext},\n      createElement('div', {\n        key: 'map-overlays',\n        className: 'overlays',\n        style: CONTAINER_STYLE,\n        children: this.props.children\n      })\n    );\n  }\n\n  render() {\n    const {className, width, height, style, visibilityConstraints} = this.props;\n    const mapContainerStyle = Object.assign({position: 'relative'}, style, {width, height});\n\n    const visible = this.props.visible &&\n      checkVisibilityConstraints(this.props.viewState || this.props, visibilityConstraints);\n\n    const mapStyle = Object.assign({}, CONTAINER_STYLE, {\n      visibility: visible ? 'inherit' : 'hidden'\n    });\n\n    return createElement('div', {\n      key: 'map-container',\n      style: mapContainerStyle,\n      children: [\n        createElement('div', {\n          key: 'map-mapbox',\n          ref: this._mapboxMapRef,\n          style: mapStyle,\n          className\n        }),\n        // AutoSizer is a pure component and does not rerender when map props change\n        // rebind the callback so that it's triggered every render pass\n        createElement(AutoSizer, {\n          key: 'autosizer',\n          disableWidth: Number.isFinite(width),\n          disableHeight: Number.isFinite(height),\n          onResize: this.props.onResize\n        }, this._renderOverlays.bind(this)),\n        this._renderNoTokenWarning()\n      ]\n    });\n  }\n}\n"],"file":"static-map.js"}